# 행렬식

행렬식을 알아보고 정방 행렬의 역행렬 존재 조건과 야코비안 다변수 미적분에서 중요한 역할을 하는 아이디어에 대해 알아보자. 

## 행렬식 소개

!!! def ""

    $2 \times 2$ 행렬 $A$ 의 행렬식 : 행렬 $A$
    
    $$ A = \begin{bmatrix} a _{11} & a _{12}\\a _{21} & a _{22} \end{bmatrix} $$
    
    에 대한 행렬식은  
    
    $$\det A = a_{11}a_{22} - a_{12}a_{21}$$
    
    이다.

- $2 \times 2$ 행렬이 역행렬을 가지기 위해서는 그것의 행렬식이 $0$ 이 아니어야 했다. 

- 이제 이것을 고차 행렬에 적용하기 위하여 $n \times n$ 행렬식의 일반적 정의를 알아보자. 

### $3 \times 3$ 행렬의 행렬식

!!! def ""

    $3 \times 3$ 행렬 $A$ 의 행렬식 : 행렬 $A$ 
    
    $$ \begin{bmatrix} a_{11}&a_{12}&a_{13}\\ a_{21}&a_{22}&a_{23}\\ a_{31}&a_{32}&a_{33}\\ \end{bmatrix} $$
    
    에 대한 행렬식은
    
    $$\det A = a_{11}a_{22}a_{33} +a_{12}a_{23}a_{31} +a_{13}a_{21}a_{32} -a_{11}a_{23}a_{32} -a_{12}a_{21}a_{33} -a_{13}a_{22}a_{31}$$
    
    이다.

- 증명 

    $a_{11} \neq 0$ 인 행렬 $A = \begin{bmatrix} a_{ij}\\ \end{bmatrix}$ 를 생각하자. $a_{11} \neq 0$ 이므로 다음 연산이 가능하다.

    $$ \begin{bmatrix} a_{11}&a_{12}&a_{13}\\ a_{11}a_{21}&a_{11}a_{22}&a_{11}a_{23}\\ a_{11}a_{31}&a_{11}a_{32}&a_{11}a_{33}\\ \end{bmatrix} \sim \begin{bmatrix} a_{11}&a_{12}&a_{13}\\ 0&a_{11}a_{22} - a_{12}a_{21}&a_{11}a_{23} - a_{13}a_{21}\\ 0&a_{11}a_{32} - a_{12}a_{31}&a_{11}a_{33} - a_{13}a_{31}\\ \end{bmatrix} $$

    $A$ 의 역행렬이 존재하므로 $(2, 2)$ 또는 $(3, 2)$ 는 $0$ 이 아니다. $(2, 2)$ 를 $0$ 이라 가정하자.(그렇지 않다면 행변환을 통하여 $0$ 이 되지 않도록 만들 수 있다.) 그러면 다음 연산이 가능하다. 

    $$ A \sim \begin{bmatrix} a_{11}&a_{12}&a_{13}\\ 0&a_{11}a_{22} - a_{12}a_{21}&a_{11}a_{23} - a_{13}a_{21}\\ 0&0&a_{11}\Delta \\ \end{bmatrix} $$

    $$ \Delta = a_{11}a_{22}a_{33} +a_{12}a_{23}a_{31} +a_{13}a_{21}a_{32} -a_{11}a_{23}a_{32} -a_{12}a_{21}a_{33} -a_{13}a_{22}a_{31} $$

    $A$ 의 역행렬이 존재하므로 $\Delta$ 도 $0$ 이 아니다. 

    이렇게 구한 $\Delta$ 가 $3 \times 3$ 행렬의 행렬식이다.

!!! def ""

    $1 \times 1$ 행렬 $A$ 의 행렬식 : $1 \times 1$ 행렬의 행렬식은 $\det A = a_{11}$ 로 정의한다.



!!! def ""

    $3$ 차 정방행렬의 행렬식을 $2$ 차 정방행렬의 행렬식으로 표현하기 : $3 \times 3$ 행렬 $A$ 의 행렬식 
    
    $$\det A = a_{11}a_{22}a_{33} +a_{12}a_{23}a_{31} +a_{13}a_{21}a_{32} -a_{11}a_{23}a_{32} -a_{12}a_{21}a_{33} -a_{13}a_{22}a_{31}$$
    
    을 $2 \times 2$ 행렬의 행렬식으로 표현하면
    
    $$ \det A = a_{11}(a_{22}a_{33} - a_{23}a_{32} )-a_{12}(a_{21}a_{33} - a_{23}a_{31}) +a_{13}(a_{21}a_{32}  -a_{22}a_{31}) $$
    
    $$ = a_{11} \cdot \det \begin{bmatrix} a_{22}&a_{23}\\a_{32}&a_{33} \end{bmatrix} - a_{12} \cdot \det \begin{bmatrix} a_{21} & a_{23}\\a_{31} & a_{33} \end{bmatrix} + a_{13} \cdot \det \begin{bmatrix} a_{21}&a_{22}\\a_{31}&a_{32} \end{bmatrix} $$
    
    $$ = a_{11} \cdot \det A_{11} - a_{12} \cdot \det A_{12} + a_{13} \cdot \det A_{13} $$
    
    이다.

- $A_{ij}$ 는 정방행렬 $A = [a_{ij}]$ 에서 $i$ 행과 $j$ 열을 제거한 부분행렬이다. 

- 따라서 $A_{11}$ 은 $3 \times 3$ 정방행렬 $A$ 에서 $1$ 행과 $1$ 열을 제거한 부분행렬이고, $A_{12}$ 과 $A_{13}$ 도 같은 의미가 적용된다. 

- 고차 행렬로의 일반화를 위하여 $3 \times 3$ 행렬의 행렬식을 $2 \times 2$ 행렬의 행렬식으로 표현하여 어떤 관계가 있는지 밝힌 것이다.

    그 관계가 $n$ 차 행렬의 행렬식을 $n+1$ 차 행렬의 행렬식으로 도약하게끔 할 수 있다면 그 관계로써 일반적인 행렬의 행렬식을 도출할 수도 있을 것이기 때문이다.

### 고차 행렬로의 일반화 - $n$ 차 정방행렬의 행렬식을 $n-1$ 차 정방행렬의 행렬식으로 표현하기

!!! def ""

    $n \times n$ 행렬의 행렬식 : $n \geq 2$ 에 대해서 $n \times n$ 행렬 $A$ 의 행렬식은 양과 음 부호가 번갈아가며 나타나는 $n$ 개의 $\pm a_{1j} \det A_{1j}$ 항으로써 다음과 같이 정의된다. 
    
    $$ det A = a_{11} \det A_{11} - a_{12} \det A_{12} + \dots + (-1)^{1+n} a_{1n} \det A_{1n} $$
    
    $$ = \sum_{j=1}^{n}(-1)^{1+j}a_{1j}\det A_{1j}$$

- 증명 

    $n=3$ 일 때 행렬 $A$ 의 행렬식 $\det A$ 는 $2 \times 2$ 부분행렬들인 $A_{1j}$ 행렬식으로 정의되었다.

    비슷하게 $n=4$ 일 때에는 $3 \times 3$ 행렬들의 부분행렬인 $A_{1j}$ 들로 정의된다.

    또한 일반적으로 비슷하게 $n \times n$ 행렬의 행렬식은 $(n-1) \times (n-1)$ 행렬들의 부분행렬의 행렬식으로 정의한다. 

- 여기서 $a_{11}, a_{12}, \dots, a_{1n}$ 은 행렬 $A$ 의 첫번째 행 요소들이다. 

- 예시 

    다음 행렬의 행렬식을 구하자.

    $$ A = \begin{bmatrix} 1&5&0\\2&4&-1\\0&-2&0 \end{bmatrix} $$

    정의에 따라 행렬식은 다음과 같이 계산된다.

    $$ \det A = 1 \cdot \det \begin{bmatrix} 4&-1\\-2&0 \end{bmatrix} -5 \cdot \det \begin{bmatrix} 2&-1\\0&0 \end{bmatrix} + 0 \cdot \det \begin{bmatrix} 2&4\\0&-2 \end{bmatrix} = -2 $$

    한편 행렬식을 표기하기 위한 특수한 방법으로 두 개의 수직선을 이용할 수도 있다. 

    $$ \det A = 1 \cdot \begin{vmatrix} 4&-1\\-2&0 \end{vmatrix} -5 \cdot \begin{vmatrix} 2&-1\\0&0 \end{vmatrix} + 0 \cdot \begin{vmatrix} 2&4\\0&-2 \end{vmatrix} = -2 $$

!!! def ""

    행렬식 표기법 : 행렬식 $\det \begin{bmatrix} a&b\\c&d \end{bmatrix}$ 를 두 수직선을 사용하여 $\begin{vmatrix} a&b\\c&d \end{vmatrix}$ 로 축약하여 사용할 수 있다.

!!! def ""

    여인수(cofactor) : 주어진 행렬 $A=[a_{ij}]$ 에 대하여 행렬 $A$ 의 $(i,j)$ 여인수 $C_{ij}$ 는 $(-1)^{i+j} \det A_{ij}$ 이다.

- $C_{ij}= (-1)^{i+j} \det A_{ij}$ 

- 예시 

    행렬 $A$ 의 행렬식은 다음과 같이 표현되며 $1$ 행에 관한 여인수 전개라 한다.

    $$\det A = a_{11}C_{11} + a_{12}C_{12} + \dots + a_{1n}C_{1n}$$

!!! def ""

    여인수 전개(cofactor expansion)

- 예시

    $3$ 행에 관한 여인수 전개 : $\det A = a_{31}C_{31} + a_{32}C_{32} + \dots + a_{3n}C_{3n}$

    $7$ 열에 관한 여인수 전개 : $\det A = a_{17}C_{17} + a_{27}C_{27} + \dots + a_{n7}C_{n7}$

!!! def ""

    **Theorem 1** $n \times n$ 행렬 $A$ 의 행렬식은 임의의 행 $i$ 또는 임의의 열 $j$ 에 대한 여인수 전개로 표현할 수 있다.

- $i$ 번째 행에 대한 여인수 전개

    $\det A = a_{i1}C_{i1} + a_{i2}C_{i2} + \dots + a_{in}C_{in}$

- $i$ 번째 행에 대한 여인수 전개

    $\det A = a_{1j}C_{1j} + a_{2j}C_{2j} + \dots + a_{nj}C_{nj}$

- 예시 : 다음 행렬의 행렬식을 구하라.

    $$ A = \begin{bmatrix} 3&-7&8&9&-6\\ 0&2&-5&7&3\\ 0&0&1&5&0\\ 0&0&2&4&-1\\ 0&0&0&-2&0\\ \end{bmatrix} $$

    이 행렬의 $1$ 열은 첫 요소를 제외하면 $0$ 이기 때문에 $1$ 열에 대한 여인수 전개로 행렬식을 다음과 같이 표현할 수 있다.

    $$ \det A = 3 \cdot \begin{vmatrix} 2&-5&7&3\\ 0&1&5&0\\ 0&2&4&-1\\ 0&0&-2&0 \end{vmatrix} + 0 \cdot C_{21} + 0 \cdot C_{31} + 0 \cdot C_{41} + 0 \cdot C_{51} $$

    그런데 또 다시 $1$ 열이 첫 요소를 제외하면 $0$ 이기에 같은 방법을 적용할 수 있다.

    $$ \det A = 3 \cdot 2 \cdot \begin{vmatrix} 1&5&0\\ 2&4&-1\\ 0&-2&0 \end{vmatrix} = 3 \cdot 2 \cdot -2 $$

    그런데 이 예제로써 다음 정리가 성립함을 직관적으로 알 수 있다.

!!! def ""

    **Theorem 2** 행렬 $A$ 가 삼각 행렬이면 행렬식 $\det A$ 는 주 대각요소들의 곱이다.

- 삼각행렬에 대한 $1$ 열 여인수 전개의 반복으로 가능하다. 

## 3.2 행렬식의 성질

!!! def ""

    **Theorem 3** 행연산과 행렬식의 관계 : $A$ 를 정방행렬이라 하자.

- (교체) 행렬 $A$ 의 한 행의 상수배를 다른 행에 더하여 행렬 $B$ 를 만들면, $\det B = \det A$ 이다.

- (교환) 행렬 $A$ 의 두 행을 교환하여 행렬 $B$ 를 만들면, $\det B = - \det A$ 이다.

- (스칼라곱) 행렬 $A$ 의 한 행을 $k$ 배 하여 행렬 $B$ 를 만들면, $\det B = k \cdot \det A$ 이다.

- 증명

    **구체화 필요**

!!! def ""

    $\det A$ 의 값 : 행렬 $A$ 를 행 교환과 행 교체에 의하여 사다리꼴 행렬 $U$ 로 변환하였다고 하고 행 교체가 $r$ 번 있었다고 하면 $\det A$ 는 다음과 같다.

- 단, $u_{ii}$ 는 사다리꼴 행렬 $U$ 의 대각성분을 뜻한다.

    $$ \det A = \begin{cases} (-1)^r \cdot (\prod_{i=1}^{n}u_{ii}) &\text{A 의 역행렬이 존재할 때}\\ 0&\text{A 의 역행렬이 존재하지 않을 때}\\ \end{cases} $$

- 컴퓨터에서 일반적인 행렬 $A$ 의 행렬식을 계산할 때 바로 이 수식을 사용하여 계산한다. 가장 최적화되어 있기 때문이다. 

- 예시 

    다음 행렬 $A$ 의 $\det A$ 를 계산하라.

    $$ A = \begin{bmatrix} 2&-7&6&7\\3&-9&5&10\\-3&0&1&-2\\1&-4&0&6 \end{bmatrix} $$

    행렬 $A$ 의 행렬식 $\det A$ 의 값은 $1$ 행에 관한 여인수 전개로 구한다면 어차피 첫째 행의 $2$ 를 곱하여야 하므로 계산을 편하게 할 수 있도록 첫째 행에서 $2$ 를 묶어낸다.

    $$ \det A = 2 \begin{vmatrix} 1&-4&3&4\\3&-9&5&10\\-3&0&1&-2\\1&-4&0&6 \end{vmatrix} = 2 \begin{vmatrix} 1&-4&3&4\\0&3&-4&-2\\0&-12&10&10\\0&0&-3&2 \end{vmatrix} \sim 2 \begin{vmatrix} 1&-4&3&4\\0&3&-4&-2\\0&0&-6&2\\0&0&0&1 \end{vmatrix} = 2 \cdot (1)(3)(-6)(1) = -36 $$

!!! def ""

    **Theorem 4** 정방행렬 $A$ 의 역행렬이 존재하면 $\det A \neq 0$ 이고 그 역도 성립한다.

### 열 연산

!!! def ""

    **Theorem 5** 행렬 $A$ 가 $n \times n$ 이면 $\det A^T = \det A$ 이다.

- $n=1$ 일 때 이 정리는 자명하다.

- $n=k$ 일 때 이 정리가 성립한다고 가정하자.

    - 그러면 $n=k+1$ 일 때 행렬 $A$ 에 속하는 여인수 $a_{1j}$ 는 $A^T$ 에 속한 여인수 $a_{j1}$ 과 같다. 

    - 따라서 $\det A$ 를 구하기 위한 $1$ 행에 대한 여인수 전개는 $1$ 열에 대한 여인수 전개와 동일하다.

    - 그런데 $1$ 열에 대한 여인수 전개는 $\det A^T$ 를 계산하므로 $\det A = \det A^T$ 이다.

- 그러므로 모든 자연수 $n$ 에 대하여 본 명제는 참이다.

!!! def ""

    **Theorem 6** 행렬식의 곱 : 행렬 $A, B$ 가 $n \times n$ 행렬이면 $\det AB = (\det A)(\det B)$ 이다.

- 증명

    **구체화 필요**

### 행렬식 함수는 선형이다

$n \times n$ 행렬 $A$ 의 $j$ 번째 열을 제외한 나머지 열이 고정값이라고 하고 다음과 같이 표현하자.

$$ A = \begin{bmatrix} a_1&\dots&a_{j-1}&x&a_{j+1}&\dots&a_n \end{bmatrix} $$

그리고 $\mathbb{R} ^n$ 에서 $\mathbb{R}$ 로 보내는 변환 $T$ 를 다음과 같이 행렬식 함수로 정의하자.

$$ T(x) = \det \begin{bmatrix} a_1&\dots&a_{j-1}&x&a_{j+1}&\dots&a_n \end{bmatrix} $$

!!! def ""

    행렬식 함수의 선형성 : 그러면 다음이 성립한다.

- $T(cx) = cT(x)$

- $T(u+v) = T(u) + T(v)$

## 3.3 크래머의 공식, 부피, 선형변환

!!! def ""

    $A_i(b)$ : 임의의 $n \times n$ 행렬 $A$ 와 $\mathbb{R} ^n$ 에 속한 임의의 $b$ 에 대해서 $A$ 의 $i$ 번째 열을 벡터 $b$ 로 바꾼 행렬이다.

- $A_i(b) = \begin{bmatrix} a_1&\dots&b&\dots&a_n\\ \end{bmatrix}$

    - $b = col i$

!!! def ""

    크래머의 공식(Cramer's rule) : 역행렬을 가지는 $n \times n$ 행렬 $A$ 와 $\mathbb{R} ^n$ 에 속한 임의의 $b$ 에 대하여 $Ax = b$ 의 유일한 해 $x$ 는 다음과 같다.

    $$x_i = \frac{\det A_i(b)}{\det A}, i = 1, 2, \dots, n$$

- 증명

    **구체화 필요**

!!! def ""

    $A^-1 를 위한 공식$

!!! def ""

    **Theorem 8**

!!! def ""

    **Theorem 9**

선형변환