# 이항분포

!!! def ""

    이항분포(binomial distribution) : 한 번의 시행에서 사건 $A$ 가 일어날 확률이 $p$ 이고
    
    $n$ 번의 독립시행에서 사건 $A$ 가 일어나는 횟수를 확률변수 $X$ 라고 할 때
    
    $q=1-p$ 와 $x = 0,1,2,\dots, n$ 에 대한 확률변수 $X$ 의 확률질량함수는
    
    $$ P(X=x) = {}_{n}C_{x}p ^{x}q ^{n-x} $$
    
    인데 이러한 $X$ 의 확률분포를 이항분포
    
    $$ \boxed{B(n, p)} $$
    
    라 한다.

- 증명 

    독립시행의 확률이란 매회의 시행에서 사건 $A$ 가 일어날 확률이 $p$ 일 때,

    $n$ 회의 독립시행에서 사건 $A$ 가 $r$ 회 일어날 확률 $P_r$ 은 $q = 1-p, r = 0, 1, 2, \dots, n$ 에 대하여

    $$ P_r = {}_{n}C_{r}p ^{r}(1-p)^{n-r} = {}_{n}C_{r} p ^{r}q ^{n-r} $$

    이었다.

    그러므로 사건 $A$ 가 일어나는 횟수를 $X$ 로 두면 $X$ 를 $0, 1, 2, \dots, n$ 의 값을 갖는 확률변수로 생각할 수 있다.

    그러므로 $X$ 의 확률질량함수는 $q=1-p$ 와 $x = 0,1,2,\dots, n$ 에 대하여

    $$ \therefore P(X=x) = {}_{n}C_{x}p ^{x}q ^{n-x}  $$

    이다. ■ 

- 확률변수 $X$ 의 확률분포가 이항분포

    $$ B(n, p) $$

    일 때 확률변수 $X$ 가 이항분포 $B(n, p)$ 를 따른다고 표현한다. 

- 예시 

    흰 공 $3$ 개, 검은 공 $1$ 개가 있는 주머니에서 공을 꺼내고 다시 넣는 시행을 $3$ 번 반복한다고 하자. 이때 검은 공이 나오는 횟수를 확률변수 $X$ 로 두자.

    이때 확률변수 $X$ 의 확률질량함수를 구해보자. 

    이것은 $3$ 회의 독립시행이고 검은 공이 나올 확률이 $\dfrac{1}{4}$ 이므로 확률변수 $X$ 는 이항분포

    $$ B \bigg  (3, \dfrac{1}{4}\bigg  ) $$

    를 따른다. 그러므로 확률질량함수는 $x=0,1,2,3$ 에 대하여

    $$ \therefore  P(X=x) = {}_{3}C_{x}\bigg (\dfrac{1}{4} \bigg ) ^{x} \bigg ( \dfrac{3}{4} \bigg ) ^{3-x} $$

    이다. ■ 

    이때 검은공이 $2$ 번 이상 나올 확률을 구해보면

    $$ P(X \geq 2) = P(X=2) + P(X=3)  $$

    $$ = {}_{3}C_{2}\bigg (\dfrac{1}{4}\bigg )^{2} \bigg (\dfrac{3}{4} \bigg )^{1} + {}_{3}C_{3}\bigg ( \dfrac{1}{4} \bigg )^{3}\bigg (\dfrac{3}{4}\bigg )^{0} = \dfrac{5}{32} $$

    이다.

## 이항분포의 평균, 분산, 표준편차(산포도 측정)

!!! def ""

    이항분포의 평균 : 확률변수 $X$ 가 이항분포 $B(n,p)$ 를 따를 때 
    
    이항분포의 평균은 
    
    $$ E(X) = np $$
    
    이다.

- 일반적인 이산확률변수의 확률질량함수가 $i = 1, 2, \dots, n$ 에 대하여 

    $$ P(X = x_i) = p_i $$

    로 정의된데 비해 이항분포 $B(n, p)$ 를 따르는 확률변수 $X$ 의 확률질량함수는 $x=0,1,2, \dots, n$ 와 $q = 1 - p$ 에 대하여 

    $$ P(X=x) = {}_{n}C_{x}p ^{x}q ^{n-x} $$

    로 정의된 것을 주의하자. 

- 증명 

    일반적인 이산확률변수 $X$ 의 확률질량함수가 $i = 1, 2, \dots, n$ 에 대하여 $P(X = x_i) = p_i$ 이었고 그에 대한 확률변수 $X$ 의 평균은 

    $$ E(X) = \sum_{i=1}^{n}x_i P(X=i) =  \sum_{i=1}^{n}x_ip_i $$

    이었다는 것을 우리는 이미 알고 있다. 

    이 확률변수 $X$ 가 이항분포 $B(n, p)$ 를 따른다면 확률변수 $X$ 가 갖는 값은 $0, 1, 2, \dots, n$ 이므로 $i=0,1,2,\dots, n$ 에 대하여 $x_i = i$ 이다. 따라서 평균은 

    $$ E(X) = \sum_{i=0}^{n}i \cdot  P(X=i) $$ 

    인데 여기에서 $i$ 를 조합에서 자주 사용되는 $r$ 로 바꾸자.

    그리고 이항분포 $B(n, p)$ 를 따르는 확률변수 $X$ 의 확률질량함수 $P(X=x)$ 는 

    $q = 1 - p$ 에 대하여 $P(X=x) = {}_{n}C_{x}p ^{x}q ^{n-x}$ 이므로

    $$ = \sum_{r=0}^{n}r \cdot  P(X=r) =  \sum_{r=0}^{n}r \cdot {}_{n}C_{r}p ^{r}q ^{n-r} $$

    이다. 이때 $r=0$ 경우는 $0 \cdot {}_{n}C_{0}p ^{0}q ^{n} = 0$ 이 되어 생각할 필요가 없으므로 $r=1$ 의 경우부터 생각하여

    $$ = \sum_{r=1}^{n}r \cdot \dfrac{n!}{(n-r)!r!}p ^{r}q ^{n-r} = \sum_{r=1}^{n}\dfrac{n!}{(n-r)!(r-1)!}p ^{r}q ^{n-r} $$

    $$ = \sum_{r=1}^{n}np \cdot \dfrac{(n-1)!}{(n-r)!(r-1)!}p ^{r-1}q ^{n-r} = np \sum_{r=1}^{n} \dfrac{(n-1)!}{(n-r)!(r-1)!}p ^{r-1}q ^{n-r} $$

    $$ = np \sum_{r=1}^{n} {}_{n-1}C_{r-1} p ^{r-1}q ^{(n-1)-(r-1)} 

    $$ = np \sum_{r=0}^{n-1} {}_{n-1}C_{r} p ^{r}q ^{(n-1)-(r)} $$

    이다. 여기에서 $r$ 에 $1$ 을 더해주면

    $$ = np \sum_{r=0}^{n-1} {}_{n-1}C_{r} p ^{r}q ^{(n-1)-(r)} $$

    인데 이항정리 $\displaystyle (a+b) ^{n} = \sum_{r=0}^{n}{}_{n}C_{r}a ^{n-r}b ^{r}$ 에 의하여

    $$ = np (p+q) ^{n-1} $$ 

    이다. 이때 $q=1-p$ 에서 $p+q=1$ 이므로 

    $$ = np $$

    이다. 그러므로 이항분포 $B(n, p)$ 를 따르는 이산확률변수 $X$ 의 평균은

    $$ \therefore  E(X) = np $$

    이다. ■

!!! def ""

    이항분포의 분산 : 확률변수 $X$ 가 이항분포 $B(n,p)$ 를 따를 때 
    
    이항분포의 분산은 $q = 1-p$ 에 대하여
    
    $$ V(X) = npq $$
    
    이다.

- 증명 

    확률변수 $X$ 의 분산은 

    $$ V(X) = E(X ^{2}) - \{E(X)\} ^{2} $$

    이었다. $E(X) = np$ 이었으므로 $E(X ^{2})$ 를 구해보자.

    확률변수 $X$ 가 이항분포 $B(n, p)$ 를 따른다면 확률변수 $X$ 가 갖는 값은 $0, 1, 2, \dots, n$ 이므로 확률변수 $X^2$ 가 갖는 값은 $0 ^{2}, 1 ^{2}, 2 ^{2}, \dots, n ^{2}$ 이다. 따라서 $X^2$ 의 평균은 

    $$ E(X ^{2}) = \sum_{r=0}^{n}r ^{2} \cdot  P(X ^{2}=r) $$ 

    이다. 그런데 이항분포 $B(n, p)$ 를 따르는 확률변수 $X$ 의 확률질량함수 $P(X=x)$ 는 

    $q = 1 - p$ 에 대하여 $P(X=x) = {}_{n}C_{x}p ^{x}q ^{n-x}$ 인데 확률변수 $X$ 에 제곱을 하여 $X^2$ 를 만들었다고 해도 그에 대응되는 확률이 변하지는 않으므로 확률질량함수는 변하지 않는다.

    따라서 

    $$ = \sum_{r=0}^{n}r ^{2} \cdot  P(X ^{2}=r) =\sum_{r=0}^{n}r ^{2} \cdot  P(X =r) = \sum_{r=0}^{n} r ^{2} {}_{n}C_{r}p ^{r}q ^{n-r} $$ 

    인데 $r ^{2} = r(r-1) + r$ 이므로

    $$ = \sum_{r=0}^{n} r(r-1)  {}_{n}C_{r}p ^{r}q ^{n-r}+\sum_{r=0}^{n} r  {}_{n}C_{r}p ^{r}q ^{n-r}  $$ 

    이다. 이때 $r=0, 1$ 일 때 $\displaystyle  \sum_{r=0}^{n} r(r-1)  {}_{n}C_{r}p ^{r}q ^{n-r}$ 는 생각할 필요가 없고 $\displaystyle  \sum_{r=0}^{n} r  {}_{n}C_{r}p ^{r}q ^{n-r} = E(X)$ 이므로

    $$ = \sum_{r=2}^{n} r(r-1) \dfrac{n!}{(n-r)!r!} p ^{r}q ^{n-r}+E(X)$$ 

    $$ = n(n-1)p ^{2}\sum_{r=2}^{n} \dfrac{(n-2)!}{(n-r)!(r-2)!} p ^{r-2}q ^{(n-2)-(r-2)}+np$$ 

    이다. 이때 $r$ 에 $2$ 를 더하면 

    $$ = n(n-1)p ^{2}\sum_{r=0}^{n-2} \dfrac{(n-2)!}{(n-(r+2))!r!} p ^{r}q ^{(n-2)-r}+np$$ 

    $$ = n(n-1)p ^{2}\sum_{r=0}^{n-2} \dfrac{(n-2)!}{(n-2-r)!r!} p ^{r}q ^{(n-2)-r}+np$$ 

    $$ = n(n-1)p ^{2}\sum_{r=0}^{n-2} {}_{n-2}C_{r} p ^{r}q ^{(n-2)-r}+np$$ 

    이다. 또 이항정리 $\displaystyle (a+b) ^{n} = \sum_{r=0}^{n}{}_{n}C_{r}a ^{n-r}b ^{r}$ 에 의하여

    $$ = n(n-1)p ^{2} (p+q) ^{n-2} + np$$

    이고 $p+q=1$ 이므로 

    $$ = n(n-1)p ^{2} + np$$

    $$ = n ^{2} p ^{2} - n p ^{2} + np $$

    $$ = n ^{2} p ^{2} + np(1-p) $$

    이다. 즉, 

    $$ E(X ^{2}) = n ^{2} p ^{2} + np(1-p) $$

    임을 알 수 있다. 따라서 확률변수 $X$ 의 분산은

    $$ V(X) = E(X ^{2}) - \{E(X)\} ^{2} $$

    $$ = n ^{2} p ^{2} + np(1-p) - n ^{2}p ^{2} $$

    $$ = np(1-p) $$

    $$ = npq  $$

    에서 

    $$ \therefore  V(X) = npq $$

    이다. ■

!!! def ""

    이항분포의 표준편차 : 확률변수 $X$ 가 이항분포 $B(n,p)$ 를 따를 때 
    
    이항분포의 표준편차는 $q = 1-p$ 에 대하여
    
    $$ \sigma (X) = \sqrt[]{npq} $$
    
    이다.

- 증명 

    이항분포 $B(n, p)$ 를 따르는 확률변수 $X$ 의 분산은 $q = 1-p$ 에 대하여

    $$ V(X) = npq $$

    이므로 표준편차는 

    $$ \therefore  \sigma (X) = \sqrt[]{V(X)} = \sqrt[]{npq} $$

    이다. ■ 

- 예시 

    각 면에 $1,2,3,4$ 가 적혀있는 정사면체를 $100$ 번 던져서 밑면의 숫자가 $2$ 가 되는 횟수를 확률변수 $X$ 라고 하자. 

    $X$ 의 평균, 분산, 표준편차를 구해보자.

    먼저 $100$ 의 시행이 독립시행이고 한 번의 시행에서 숫자 $2$ 가 나올 확률이 $\dfrac{1}{4}$ 이므로

    확률변수 $X$ 는 이항분포 $B \bigg (100, \dfrac{1}{4} \bigg )$ 를 따른다. 

    따라서 확률변수 $X$ 의 평균은 

    $$ \therefore E(X) = np = 100 \times \dfrac{1}{4} = 25 $$

    이고 분산은

    $$ \therefore V(X) = npq = 100 \times \dfrac{1}{4} \times \dfrac{3}{4} = \dfrac{75}{4} $$

    이고 표준편차는 

    $$ \therefore \sigma (X) = \sqrt[]{\dfrac{75}{4}} = \dfrac{ 5 \sqrt[]{3}}{2} $$

    이다. ■ 

    $E(X) = 25$ 를 통해 정사면체를 $100$ 번 던졌을 때 숫자 $2$ 가 $25$ 정도 나올 것이라고 생각할 수 있다. 

## 큰 수의 법칙

!!! def ""

    큰 수의 법칙(law of large number) : 어떤 시행에서 사건 $A$ 가 일어날 확률이 $p$ 일 때
    
    $n$ 번의 독립시행에서 사건 $A$ 가 일어나는 횟수를 $X$ 라 하면
    
    확률변수 $X$ 는 이항분포 $B(n, p)$ 를 따르는데 이때 아무리 작은 양수 $h$ 를 택하더라도 
    
    $$ \lim_{n \to \infty} P \bigg ( \bigg | \dfrac{X}{n} - p \bigg | < h \bigg ) = 1 $$
    
    이 성립한다.

- 설명 

    주사위를 $n$ 번 던지는 시행에서 $5$ 가 나오는 횟수를 $X$ 라고 하자. 그러면 확률변수 $X$ 는 $n$ 번의 독립시행과 $\dfrac{1}{6}$ 의 사건이 일어날 확률을 갖는 이항분포

    $$ B \bigg  (n, \dfrac{1}{6}\bigg  ) $$

    를 따른다. 그러므로 확률변수 $X$ 의 확률질량함수 $P(X=x)$ 는 $x = 1,2,3, \dots, n$ 에 대하여

    $$ P(X=x) = {}_{n}C_{x} \bigg (\dfrac{1}{6}\bigg ) ^{x} \bigg ( \dfrac{5}{6}\bigg ) ^{n-x} $$

    이다. 

    이제 $n=10$ 번의 시행에서 $5$ 가 $X$ 번 나왔다고 하면 이것을 상대도수이자 확률 $\dfrac{X}{10}$ 로 표현할 수 있다. 이 통계적 확률이 수학적 확률 $\dfrac{1}{6}$ 과 얼마나 차이를 가지는가?

    가령 통계적 확률 $\dfrac{X}{10}$ 과 수학적 확률 $\dfrac{1}{6}$ 의 차이가 $0.1$ 미만일 확률을 구해보면 다음과 같다. 

    $$ P \bigg ( \bigg | \dfrac{X}{10} - \dfrac{1}{6} \bigg | < 0.1 \bigg ) = P \bigg ( -0.1 < \dfrac{X}{10} - \dfrac{1}{6} < 0.1 \bigg ) $$

    $$ = P \bigg ( -1 < X - \dfrac{5}{3} < 1 \bigg ) = P \bigg ( \dfrac{2}{3} < X  < \dfrac{8}{3} \bigg ) $$

    $$ = P(X=1) + P(X=2) $$

    $$ = 0.323 + 0.291 = 0.614 $$

    그렇다면 시행을 $30$ 번 반복했을 때, 즉 $n=30$ 에서 통계적 확률 $\dfrac{X}{30}$ 과 수학적 확률 $\dfrac{1}{6}$ 의 차이가 $0.1$ 미만일 확률은 어떨까? 

    $$ P \bigg ( \bigg | \dfrac{X}{30} - \dfrac{1}{6} \bigg | < 0.1 \bigg ) = P \bigg ( -0.1 < \dfrac{X}{30} - \dfrac{1}{6} < 0.1 \bigg ) $$

    $$ = P \bigg ( 2 < X < 8 \bigg ) = P(X=3) + P(X=4) + \dots + P(X=7) $$

    $$ = 0.137 + 0.185 + \dots + 0.110 = 0.784 $$

    이제 시행횟수를 $50$ 회로 높혀서, 즉 $n=50$ 때의 통계적 확률 $\dfrac{X}{30}$ 과 수학적 확률 $\dfrac{1}{6}$ 의 차이가 $0.1$ 미만일 확률을 구해보자. 

    $$ P \bigg ( \bigg | \dfrac{X}{50} - \dfrac{1}{6} \bigg | < 0.1 \bigg ) = P \bigg ( -0.1 < \dfrac{X}{50} - \dfrac{1}{6} < 0.1 \bigg ) $$

    $$ = P \bigg ( \dfrac{10}{3} < X < \dfrac{40}{3} \bigg ) = P(X=4) + P(X=5) + \dots + P(X=13) $$

    $$ = 0.040 + 0.075 + \dots + 0.032 = 0.946 $$

    이처럼 시행횟수 $n$ 을 계속 높히니까 더할 수 있는 $P(X=x)$ 들이 많아지면서 통계적 확률 $\dfrac{X}{n}$ 이 수학적 확률 $\dfrac{1}{6}$ 과 차이가 $0.1$ 미만일 확률이 높아짐을 일 수 있다. 

    이때 $n$ 을 한없이 크게 만들면, 즉 $n \to \infty$ 이면 

    $$ \lim_{n \to \infty} P \bigg ( \bigg | \dfrac{X}{n} - \dfrac{1}{6} \bigg | < 0.1 \bigg ) = 1 $$

    와 같이 통계적 확률과 수학적 확률의 차이가 $0.1$ 미만일 확률이 $1$ 에 한없이 가까워진다는 것을 알 수 있다. 

    이것은 양수 $0.1$ 을 $0.01$ 이나 $0.0000000000001$ 같이 한없이 작게 만들어도 성립한다. 

    그러므로 이제 양수 $0.1$ 을 임의의 양수 $h$ 로 두고 수학적 확률 $\dfrac{1}{6}$ 도 일반적인 확률 $p$ 로 두자. 그러면 통계적확률(상대도수) $\dfrac{X}{n}$ 과 수학적확률 $p$ 이 거의 똑같아질 확률, 다시 말해 둘의 차이값이 임의의 양수보다 작을 확률이

    시행횟수 $n$ 을 한없이 크게 만들면 다음과 같이 $1$ 에 수렴한다는 것을 알 수 있다. 

    $$ \lim_{n \to \infty} P \bigg ( \bigg | \dfrac{X}{n} - p \bigg | < h \bigg ) = 1 $$

    이것은 쉽게 말해 그냥 시행횟수를 한없이 늘리면 통계적확률과 수학적확률이 똑같아진다는 것을 의미한다.

# 체비세프의 부등식

!!! def ""

    체비세프의 부등식(Chebyshev's inequality) : 확률변수 $X$ 의 평균이 $\mu$, 표준편차가 $\sigma$ 이고 자료의 총수가 $N$ 일 때
    
    $1$ 보다 큰 임의의 양수 $k$ 에 대하여 $|X- \mu | < k \sigma$ 를 만족시키는 자료의 수는 
    
    $$ N \bigg (1 - \dfrac{1}{k^2} \bigg ) $$
    
    개 이상이다. 
    
    **구체화 필요**

- 즉, $\mu - k \sigma < x_i < \mu + k \sigma$ 을 만족하는 $x_i$ 는 전체의 $1 - \dfrac{1}{k^2}$ 이상이다. 

- 예시 

    어떤 학교의 전교생은 $450$ 명이다. 이 학교의 수학 점수 평균이 $70$ 점, 표준편차가 $3$ 점이었다. 

    $61$ 점 이상 $79$ 점 이하인 학생은 몇 명 이상인지 체비세프 부등식으로 추정해보자. 

    **구체화 필요**

# 베르누이 시행

!!! def ""

    베르누이 시행 :

**구체화 필요**

